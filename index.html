<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Clement Escoffier">
<title>SmallRye Reactive Messaging</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="assets/style/foundation-potion.css" media="screen" rel="stylesheet">

<script>

</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>SmallRye Reactive Messaging</h1>
<div class="details">
<span id="author" class="author">Clement Escoffier</span><br>
<span id="revnumber">version 1.0.0-SNAPSHOT,</span>
<span id="revdate">2018-11-13</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">SmallRye Reactive Messaging</div>
<ul class="sectlevel2">
<li><a href="#_getting_started">1. Getting Started</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites">1.1. Prerequisites</a></li>
<li><a href="#_quickstart">1.2. Quickstart</a></li>
</ul>
</li>
<li><a href="#_concepts">2. Concepts</a>
<ul class="sectlevel3">
<li><a href="#_messages">2.1. Messages</a></li>
<li><a href="#_incoming">2.2. Incoming</a></li>
<li><a href="#_outgoing">2.3. Outgoing</a></li>
<li><a href="#_methods_with_outgoing_and_incoming">2.4. Methods with @Outgoing and @Incoming</a></li>
<li><a href="#_binding_matching_outgoing_to_incoming">2.5. Binding matching @Outgoing to @Incoming</a></li>
</ul>
</li>
<li><a href="#_generating_data">3. Generating data</a>
<ul class="sectlevel3">
<li><a href="#_supported_signatures">3.1. Supported Signatures</a></li>
<li><a href="#_examples">3.2. Examples</a></li>
</ul>
</li>
<li><a href="#_consuming_data">4. Consuming data</a>
<ul class="sectlevel3">
<li><a href="#_supported_signatures_2">4.1. Supported Signatures</a></li>
<li><a href="#_examples_2">4.2. Examples</a></li>
</ul>
</li>
<li><a href="#_processing_data">5. Processing data</a>
<ul class="sectlevel3">
<li><a href="#_manipulating_items_one_by_one">5.1. Manipulating items one by one</a></li>
<li><a href="#_consuming_one_items_and_producing_a_streams">5.2. Consuming one items and producing a streams</a></li>
<li><a href="#_creating_a_reactive_stream_processor">5.3. Creating a Reactive Stream Processor</a></li>
<li><a href="#_manipulating_streams">5.4. Manipulating streams</a></li>
<li><a href="#_reactive_streams_reactive_stream_operators_rx_java">5.5. Reactive Streams, Reactive Stream Operators, RX Java</a></li>
</ul>
</li>
<li><a href="#_acknowledgement">6. Acknowledgement</a></li>
<li><a href="#_connecting_transports">7. Connecting transports</a></li>
<li><a href="#_interacting_with_apache_kafka">8. Interacting with Apache Kafka</a>
<ul class="sectlevel3">
<li><a href="#_dependency">8.1. Dependency</a></li>
<li><a href="#_retrieving_messages_from_kafka">8.2. Retrieving messages from Kafka</a></li>
<li><a href="#_forwarding_messages_to_kafka">8.3. Forwarding messages to Kafka</a></li>
</ul>
</li>
<li><a href="#_integrating_with_apache_camel">9. Integrating with Apache Camel</a>
<ul class="sectlevel3">
<li><a href="#_dependency_2">9.1. Dependency</a></li>
<li><a href="#_camel_reactive">9.2. Camel Reactive</a></li>
<li><a href="#_using_camel_route_in_outgoing_method">9.3. Using Camel Route in @Outgoing method</a></li>
<li><a href="#_using_camel_route_in_incoming_method">9.4. Using Camel Route in @Incoming method</a></li>
<li><a href="#_retrieving_messages_from_a_camel_route">9.5. Retrieving messages from a Camel Route</a></li>
<li><a href="#_forwarding_messages_to_a_camel_route">9.6. Forwarding messages to a Camel Route</a></li>
</ul>
</li>
<li><a href="#_interacting_using_mqtt">10. Interacting using MQTT</a>
<ul class="sectlevel3">
<li><a href="#_dependency_3">10.1. Dependency</a></li>
<li><a href="#_retrieving_messages_from_mqtt">10.2. Retrieving messages from MQTT</a></li>
<li><a href="#_forwarding_messages_to_mqtt">10.3. Forwarding messages to MQTT</a></li>
<li><a href="#_advanced_configuration">10.4. Advanced configuration</a></li>
</ul>
</li>
<li><a href="#_emitting_http_requests">11. Emitting HTTP requests</a>
<ul class="sectlevel3">
<li><a href="#_dependency_4">11.1. Dependency</a></li>
<li><a href="#_forwarding_messages_to_http">11.2. Forwarding messages to HTTP</a></li>
</ul>
</li>
<li><a href="#_interacting_with_the_vert_x_eventbus">12. Interacting with the Vert.x Eventbus</a>
<ul class="sectlevel3">
<li><a href="#_dependency_5">12.1. Dependency</a></li>
<li><a href="#_retrieving_messages_from_the_event_bus">12.2. Retrieving messages from the event bus</a></li>
<li><a href="#_sending_messages_to_the_event_bus">12.3. Sending messages to the event bus</a></li>
</ul>
</li>
<li><a href="#_advanced_and_experimental_features">13. Advanced and Experimental features</a>
<ul class="sectlevel3">
<li><a href="#_merge">13.1. @Merge</a></li>
<li><a href="#_broadcast">13.2. @Broadcast</a></li>
<li><a href="#_stream">13.3. @Stream</a></li>
<li><a href="#_logging">13.4. Logging</a></li>
<li><a href="#_strict_binding_mode">13.5. Strict Binding Mode</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>SmallRye Reactive Messaging is an implementation of the (next to be) Eclipse MicroProfile Reactive Messaging specification.
It provides a way to implement reactive data streaming application using a CDI development model.</p>
</div>
<div class="paragraph">
<p>It provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a development model to build data streaming applications</p>
</li>
<li>
<p>connections for Apache Kafka, AMQP 1.0, MQTT, Apache Camel&#8230;&#8203;</p>
</li>
<li>
<p>a way to inject manipulated streams into regular CDI beans and JAX-RS resources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SmallRye Reactive Messaging enables data streaming application, event-driven and asynchronous microservices, event
sourcing applications&#8230;&#8203;</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/overview.png" alt="overview">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_started">1. Getting Started</h3>
<div class="sect3">
<h4 id="_prerequisites">1.1. Prerequisites</h4>
<div class="paragraph">
<p>Unfortunately, right now, there are no release of this project, so you need to build it by yourself. The build process
 requires Apache Maven and Java 8+.  You need to build the SmallRye Reactive Stream Operators implementation first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone git@github.com:smallrye/smallrye-reactive-streams-operators.git
cd smallrye-reactive-streams-operators
mvn clean install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, build this repository</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $ROOT
mvn clean install</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>SmallRye Reactive Messaging should work with any implementation of the Reactive Stream Operator.</p>
</li>
<li>
<p>Most of the example use Weld as CDI implementation, again, it does not contain any code specific to Weld and should
work with any implementation of CDI 2.x.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_quickstart">1.2. Quickstart</h4>
<div class="paragraph">
<p>The easiest to start using SmallRye Reactive Messaging is to start it directly in a <em>main</em> class.</p>
</div>
<div class="paragraph">
<p>Creates a Maven project, and include the following dependency in your pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-provider&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye.reactive&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-streams-operators-cdi&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.jboss.weld.se&lt;/groupId&gt;
  &lt;artifactId&gt;weld-se-core&lt;/artifactId&gt;
  &lt;version&gt;3.0.5.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once created, create a class file with a <code>public static void main(String&#8230;&#8203; args)</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.smallrye.reactive.messaging.quickstart;

import javax.enterprise.context.ApplicationScoped;
import javax.enterprise.inject.se.SeContainerInitializer;

@ApplicationScoped
public class Main {

  public static void main(String[] args) {
    SeContainerInitializer.newInstance().initialize();
  }


}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, we need CDI <em>beans</em>. For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.smallrye.reactive.messaging.quickstart;

import org.eclipse.microprofile.reactive.messaging.Incoming;
import org.eclipse.microprofile.reactive.messaging.Outgoing;
import org.eclipse.microprofile.reactive.streams.PublisherBuilder;
import org.eclipse.microprofile.reactive.streams.ReactiveStreams;

import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped
public class MyBean {

  @Outgoing("source")
  public PublisherBuilder&lt;String&gt; source() {
    return ReactiveStreams.of("hello", "with", "SmallRye", "reactive", "message");
  }

  @Incoming("source")
  @Outgoing("processed-a")
  public String toUpperCase(String payload) {
    return payload.toUpperCase();
  }

  @Incoming("processed-a")
  @Outgoing("processed-b")
  public PublisherBuilder&lt;String&gt; filter(PublisherBuilder&lt;String&gt; input) {
    return input.filter(item -&gt; item.length() &gt; 4);
  }

  @Incoming("processed-b")
  public void sink(String word) {
    System.out.println("&gt;&gt; " + word);
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you need an <em>empty</em> <code>beans.xml</code>. Copy the following content to <code>src/main/resources/META-INF/beans.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;beans
  xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
      http://xmlns.jcp.org/xml/ns/javaee
      http://xmlns.jcp.org/xml/ns/javaee/beans_1_1.xsd"&gt;

&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once everything is setup, you should be able to run the application using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn compile exc:java -Dexec.mainClass=&lt;Main fully qualified class name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the previous example should give the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&gt;&gt; HELLO
&gt;&gt; SMALLRYE
&gt;&gt; REACTIVE
&gt;&gt; MESSAGE</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can control the logging by creating a <code>log4j2.yaml</code> file in <code>src/main/resources</code>. The following content drastically
reduces the amount of messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">Configuration:
  status: info

  Appenders:
    Console:
      name: Console
      target: SYSTEM_OUT
      PatternLayout:
        Pattern: "%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"

  Loggers:
    Root:
      level: warn
      AppenderRef:
        ref: Console</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_concepts">2. Concepts</h3>
<div class="paragraph">
<p>MicroProfile Reactive Messaging proposes a model to build data streaming application using a CDI development model. It
is based on 3 main concepts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Message</code></p>
</li>
<li>
<p><code>@Incoming</code></p>
</li>
<li>
<p><code>@Outgoing</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Behind the scene, SmallRye Reactive Streams composes <em>Reactive Streams</em> and ensures the consistent flow of messages.</p>
</div>
<div class="sect3">
<h4 id="_messages">2.1. Messages</h4>
<div class="paragraph">
<p>A <code>Message</code> (defined by <code>org.eclipse.microprofile.reactive.messaging.Message</code>) is an envelope around a payload. The
<code>Message</code> interface just offers a way to retrieve the payload (<code>getPayload</code>) and to acknowledge the message (<code>ack</code>).</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/message.png" alt="message">
</div>
</div>
<div class="paragraph">
<p>The <code>Message</code> interface is parameterized with the type of the payload. For example, <code>Message&lt;String&gt;</code> describes a
message containing a <code>String</code> payload.</p>
</div>
<div class="paragraph">
<p>The interface can be subclassed by the user or by transport layers to convey more attributes. For example, a <code>Message</code>
coming from Kafka contain headers, as well as others metadata.</p>
</div>
<div class="paragraph">
<p>Acknowledgement is covered below, in a dedicated section.</p>
</div>
</div>
<div class="sect3">
<h4 id="_incoming">2.2. Incoming</h4>
<div class="paragraph">
<p><code>Incoming</code> is an annotation indicating that the method consumes a stream. The name of the stream is given as attribute
such as in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Incoming("my-stream")
public void consume(Message&lt;String&gt; s) {
  // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A method only annotated with <code>@Incoming</code> forms the end of a processing chain, often called <em>sink</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/incoming.png" alt="incoming">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_outgoing">2.3. Outgoing</h4>
<div class="paragraph">
<p><code>Outgoing</code> is an annotation indicating that the method feeds a stream. The name of the stream is given as attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Outgoing("my-stream")
public Message&lt;String&gt; produce() {
  // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A method only annotated with <code>@Outgoing</code> is a sort of data <em>source</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/outgoing.png" alt="outgoing">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_methods_with_outgoing_and_incoming">2.4. Methods with @Outgoing and @Incoming</h4>
<div class="paragraph">
<p>Of course, methods can also use both annotations to transform the incoming messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Incoming("from")
@Outgoing("to")
public String toUpperCase(String input) {
  return input.toUpperCase();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A method annotated with both annotation is generally called <em>processor</em> or <em>mediator</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/processor.png" alt="processor">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_binding_matching_outgoing_to_incoming">2.5. Binding matching @Outgoing to @Incoming</h4>
<div class="paragraph">
<p>SmallRye Reactive Messaging automatically binds matching <code>@Outgoing</code> to <code>@Incoming</code> to form a chain:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="assets/chain.png" alt="chain">
</div>
</div>
<div class="paragraph">
<p>Methods annotated with <code>@Incoming</code> or <code>@Outgoing</code> don&#8217;t have to be in the same <em>bean</em> (<em>class</em>). You can distribute them
amount a set of beans. Remote interactions are possible using a <em>transport</em> layer. This topic is covered in another
section.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generating_data">3. Generating data</h3>
<div class="paragraph">
<p>To generate data (act as a data source), you need a method annotated with <code>@Outgoing</code>.</p>
</div>
<div class="sect3">
<h4 id="_supported_signatures">3.1. Supported Signatures</h4>
<div class="ulist">
<ul>
<li>
<p><code>@Outgoing Publisher&lt;Message&lt;O&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing Publisher&lt;O&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing PublisherBuilder&lt;Message&lt;O&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing PublisherBuilder&lt;O&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing Message&lt;O&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing O method()</code></p>
</li>
<li>
<p><code>@Outgoing CompletionStage&lt;Message&lt;O&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing CompletionStage&lt;O&gt; method()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first four variants generates a stream. The other methods generate each item individually.</p>
</div>
</div>
<div class="sect3">
<h4 id="_examples">3.2. Examples</h4>
<div class="paragraph">
<p>The following code snippet provides example of the different variants of signature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.smallrye.reactive.messaging.snippets;

import org.eclipse.microprofile.reactive.messaging.Message;
import org.eclipse.microprofile.reactive.messaging.Outgoing;
import org.eclipse.microprofile.reactive.streams.PublisherBuilder;
import org.eclipse.microprofile.reactive.streams.ReactiveStreams;

import javax.enterprise.context.ApplicationScoped;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.CompletionStage;
import java.util.concurrent.Executor;
import java.util.concurrent.Executors;
import java.util.concurrent.atomic.AtomicInteger;

@ApplicationScoped
public class GenerateExamples {

  /**
   * Produces a simple stream. The produced payloads are automatically wrapped
   * into Messages.
   */
  @Outgoing("data-1")
  public PublisherBuilder&lt;String&gt; generate() {
    return ReactiveStreams.of("a", "b", "c");
  }

  /**
   * Produces a simple stream of Message.
   */
  @Outgoing("data-2")
  public PublisherBuilder&lt;Message&lt;String&gt;&gt; generateMessages() {
    return ReactiveStreams.of("a", "b", "c").map(Message::of);
  }

  private AtomicInteger counter = new AtomicInteger();

  /**
   * Generates a stream payload by payload.
   */
  @Outgoing("data-3")
  public int count() {
    return counter.incrementAndGet();
  }

  /**
   * Generates a stream message by message.
   */
  @Outgoing("data-4")
  public Message&lt;Integer&gt; countAsMessage() {
    return Message.of(counter.incrementAndGet());
  }

  private Executor executor = Executors.newSingleThreadExecutor();

  /**
   * Generates a stream message by message. The next meesage is only generated
   * when the value from the previous one is redeemed.
   */
  @Outgoing("data-5")
  public CompletionStage&lt;Message&lt;Integer&gt;&gt; produceAsyncMessages() {
    return CompletableFuture.supplyAsync(() -&gt; Message.of(counter.incrementAndGet()), executor);
  }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consuming_data">4. Consuming data</h3>
<div class="paragraph">
<p>To consume data (act as a data sink), you just need a method only annotated with <code>@Incoming</code>.</p>
</div>
<div class="sect3">
<h4 id="_supported_signatures_2">4.1. Supported Signatures</h4>
<div class="ulist">
<ul>
<li>
<p><code>@Incoming Subscriber&lt;Message&lt;I&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Incoming Subscriber&lt;I&gt; method()</code></p>
</li>
<li>
<p><code>@Incoming void method(I msg)</code></p>
</li>
<li>
<p><code>@Incoming CompletionStage&lt;?&gt; method(Message&lt;I&gt; msg)</code></p>
</li>
<li>
<p><code>@Incoming CompletionStage&lt;?&gt; method(I msg)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The two first methods return a Reactive Streams <code>Subscriber</code>. The other methods consume the incoming items one by one.
Notice that, when returning a <code>CompletionStage</code>, the method won&#8217;t be called until the previously returned
<code>CompletionStage</code> is completed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_examples_2">4.2. Examples</h4>
<div class="paragraph">
<p>The following code snippet provides example of the different variants of signature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.smallrye.reactive.messaging.snippets;


import org.eclipse.microprofile.reactive.messaging.Incoming;
import org.eclipse.microprofile.reactive.messaging.Message;
import org.eclipse.microprofile.reactive.streams.ReactiveStreams;
import org.reactivestreams.Subscriber;

import javax.enterprise.context.ApplicationScoped;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.CompletionStage;

@ApplicationScoped
public class ConsumptionExamples {

  @Incoming("data")
  public Subscriber&lt;String&gt; consume() {
    return ReactiveStreams.&lt;String&gt;builder()
      .map(String::toUpperCase)
      .findFirst()
      .build();
  }

  @Incoming("data")
  public Subscriber&lt;Message&lt;String&gt;&gt; consumeMessages() {
    return ReactiveStreams.&lt;Message&lt;String&gt;&gt;builder()
      .findFirst()
      .build();
  }

  @Incoming("data")
  public void consumeOne(String input) {
    //...
  }

  @Incoming("data")
  public CompletionStage&lt;Void&gt; consumeAsync(String input) {
    return CompletableFuture.runAsync(() -&gt; {
      // ...
    });
  }

  @Incoming("data")
  public CompletionStage&lt;Void&gt; consumeMessageAsync(Message&lt;String&gt; input) {
    return CompletableFuture.runAsync(() -&gt; {
      // ...
    });
  }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_processing_data">5. Processing data</h3>
<div class="paragraph">
<p>There are several ways to manipulate items transiting in a streams.</p>
</div>
<div class="sect3">
<h4 id="_manipulating_items_one_by_one">5.1. Manipulating items one by one</h4>
<div class="paragraph">
<p>The first possibility is to implement a method with both <code>@Incoming</code> and <code>@Outgoing</code> and receiving the <code>Message</code> or
payload one by one. For each input, an output is produced. This output can be generated asynchronously by returning a
<code>CompletionStage</code>.</p>
</div>
<div class="paragraph">
<p>The following signatures are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Outgoing @Incoming Message&lt;O&gt; method(Message&lt;I&gt; msg)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming O method(I payload)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming CompletionStage&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming CompletionStage&lt;O&gt; method(I payload)</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_consuming_one_items_and_producing_a_streams">5.2. Consuming one items and producing a streams</h4>
<div class="paragraph">
<p>Another possibility is to consume the items one by one, but instead of producing a single result, produce a stream,
potentially empty. The following method signatures are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Outgoing @Incoming Publisher&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming Publisher&lt;O&gt; method(I payload)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming PublisherBuilder&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming PublisherBuilder&lt;O&gt; method(I payload)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following method duplicates the received messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("proc-a")
  @Outgoing("proc-b")
  public PublisherBuilder&lt;String&gt; duplicate(String input) {
    return ReactiveStreams.of(input, input);
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As said above, you can potentially return an empty stream to "ignore" the outcome.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("proc-b")
  @Outgoing("proc-c")
  public PublisherBuilder&lt;String&gt; removeC(String input) {
    return ReactiveStreams.of(input)
      .filter(s -&gt; ! s.equalsIgnoreCase("c"))
      .map(String::toUpperCase);
  }</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The returned streams are concatenated and the emissions are not mixed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_reactive_stream_processor">5.3. Creating a Reactive Stream Processor</h4>
<div class="paragraph">
<p>A <em>Processor</em> is a Reactive Stream entity acting as a <em>subscriber</em> (so consume data) and <em>publisher</em> (so publish data).
To describe your data transformation logic, you can create and return a <code>Processor</code> (or a <code>ProcessorBuilder</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("proc-c")
  @Outgoing("proc-d")
  public ProcessorBuilder&lt;String, String&gt; process() {
    return ReactiveStreams.&lt;String&gt;builder()
      .map(s -&gt; "-" + s + "-");
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following methods are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Outgoing @Incoming Processor&lt;Message&lt;I&gt;, Message&lt;O&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming Processor&lt;I, O&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming ProcessorBuilder&lt;Message&lt;I&gt;, Message&lt;O&gt;&gt; method()</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming ProcessorBuilder&lt;I, O&gt; method()</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The returned streams are concatenated and the emissions are not mixed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_manipulating_streams">5.4. Manipulating streams</h4>
<div class="paragraph">
<p>You can also transform streams using the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Outgoing @Incoming Publisher&lt;Message&lt;O&gt;&gt; method(Publisher&lt;Message&lt;I&gt;&gt; pub)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming PublisherBuilder&lt;Message&lt;O&gt;&gt; method(PublisherBuilder&lt;Message&lt;I&gt;&gt; pub)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming Publisher&lt;O&gt; method(Publisher&lt;I&gt; pub)</code></p>
</li>
<li>
<p><code>@Outgoing @Incoming PublisherBuilder&lt;O&gt; method(PublisherBuilder&lt;I&gt; pub)</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_reactive_streams_reactive_stream_operators_rx_java">5.5. Reactive Streams, Reactive Stream Operators, RX Java</h4>
<div class="paragraph">
<p>SmallRye Reactive Messaging supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Publisher</code>, <code>PublisherBuilder</code> (MicroProfile Reactive Streams Operators), <code>Flowable</code> (RX Java 2)</p>
</li>
<li>
<p><code>Processor</code>, <code>ProcessorBuilder</code> (MicroProfile Reactive Streams Operators)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_acknowledgement">6. Acknowledgement</h3>
<div class="paragraph">
<p>Messages may require acknowledgment to inform the transport layer that the message has been processed. Methods
annotated with <code>@Incoming</code> and also be annotated with <code>io.smallrye.reactive.messaging.annotations.Acknowledgment</code> to
configure the acknowledgement policies.</p>
</div>
<div class="paragraph">
<p>Four policies are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NONE</code>: no acknowledgement</p>
</li>
<li>
<p><code>MANUAL</code>: the developer is responsible for the acknowledgement. It can be perform using <code>Message.ack()</code>.</p>
</li>
<li>
<p><code>PRE_PROCESSING</code>: the acknowledgement is managed automatically before the processing</p>
</li>
<li>
<p><code>POST_PROCESSING</code>: the acknowledgement is managed automatically after the processing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example describes how <code>PRE_PROCESSING</code> can be configured:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("i")
  @Outgoing("j")
  @Acknowledgment(Acknowledgment.Mode.PRE_PROCESSING)
  public String autoAck(String input) {
    return input.toUpperCase();
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Manual acknowledgement can be achieved as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("i")
  @Outgoing("j")
  @Acknowledgment(Acknowledgment.Mode.MANUAL)
  public CompletionStage&lt;Message&lt;String&gt;&gt; manualAck(Message&lt;String&gt; input) {
    return CompletableFuture.supplyAsync(input::getPayload)
      .thenApply(Message::of)
      .thenCompose(m -&gt; input.ack().thenApply(x -&gt; m));
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Default acknowledgement depends on the method signature:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 20%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Signature</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default policy</strong></th>
<th class="tableblock halign-left valign-top"><strong>Supported policy</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Incoming Subscriber&lt;Message&lt;I&gt;&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post, Manual</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Incoming Subscriber&lt;I&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Incoming void method(I msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Incoming CompletionStage&lt;?&gt; method(Message&lt;I&gt; msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post, Manual</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Incoming CompletionStage&lt;?&gt; method(I msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Processor&lt;Message&lt;I&gt;, Message&lt;O&gt;&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Processor&lt;I, O&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming ProcessorBuilder&lt;Message&lt;I&gt;, Message&lt;O&gt;&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming ProcessorBuilder&lt;I, O&gt; method()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Publisher&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Publisher&lt;O&gt; method(I payload)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming PublisherBuilder&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming PublisherBuilder&lt;O&gt; method(I payload)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Message&lt;O&gt; method(Message&lt;I&gt; msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming O method(I payload)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming CompletionStage&lt;Message&lt;O&gt;&gt; method(Message&lt;I&gt; msg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming CompletionStage&lt;O&gt; method(I payload)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre, Post</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Publisher&lt;Message&lt;O&gt;&gt; method(Publisher&lt;Message&lt;I&gt;&gt; pub)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming PublisherBuilder&lt;Message&lt;O&gt;&gt; method(PublisherBuilder&lt;Message&lt;I&gt;&gt; pub)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Manual, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming Publisher&lt;O&gt; method(Publisher&lt;I&gt; pub)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Outgoing @Incoming PublisherBuilder&lt;O&gt; method(PublisherBuilder&lt;I&gt; pub)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None, Pre</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_connecting_transports">7. Connecting transports</h3>
<div class="paragraph">
<p>SmallRye Reactive Messaging supports various transport <em>protocols</em>. This section explains how you can configure these different
 extensions. Before listing the supported transports, we need to explain the configuration format. SmallRye Reactive Messaging uses
MicorProfile Config as main configuration source. To enable the configuration, add an implementation of MicroProfile
Config in your <em>classpath</em>. For instance, add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-config&lt;/artifactId&gt;
  &lt;version&gt;1.3.4&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then create a <em>properties</em> file in <code>src/main/resources/META-INF/microprofile-config.properties</code> such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># Configure the dummy source and sink
smallrye.messaging.source.dummy-source.type=io.smallrye.reactive.messaging.providers.Dummy
smallrye.messaging.source.dummy-source.increment=3
smallrye.messaging.sink.dummy-sink.type=io.smallrye.reactive.messaging.providers.Dummy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each <em>source</em> and <em>sink</em> are configured individually in this file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>source</code> consumes data from a message broker or something producing data and can be seen as an <code>@Outgoing</code>;</p>
</li>
<li>
<p>a <code>sink</code> consumes data from the application and forward it to a message broker or something consuming data. It can be
seen as an <code>@Incoming</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration format is the follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.[source|sink].[name].[attribute]=[value]</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the <code>[source|sink]</code> segment indicates if we are configuring a <code>source</code> or a <code>sink</code></p>
</li>
<li>
<p>the <code>[name]</code> segment configures the name of the <code>source</code> or <code>sink</code></p>
</li>
<li>
<p>the <code>[attribute]</code> segment is the name of the attribute to configure. Most of the time the attributes are specific to
the transport layer</p>
</li>
<li>
<p>the <code>[value]</code> is the value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All <code>sources</code> and <code>sinks</code> must declare the <code>type</code> attribute matching the type of transport (also named <code>MessagingProvider</code>).</p>
</div>
<div class="paragraph">
<p>Here is an example of a MQTT source (consuming data from a MQTT broker) and a Kafka sink (forwarding data to Kafka):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># [Source - health] - Consume data from MQTT
smallrye.messaging.source.health.topic=neo
smallrye.messaging.source.health.type=io.smallrye.reactive.messaging.mqtt.Mqtt
smallrye.messaging.source.health.host=localhost
smallrye.messaging.source.health.broadcast=true
# [/Source - health]

# [Sink - data] - Produce data to Kafka
smallrye.messaging.sink.data.type=io.smallrye.reactive.messaging.kafka.Kafka
smallrye.messaging.sink.data.bootstrap.servers=localhost:9092
smallrye.messaging.sink.data.key.serializer=org.apache.kafka.common.serialization.StringSerializer
smallrye.messaging.sink.data.value.serializer=io.vertx.kafka.client.serialization.JsonObjectSerializer
smallrye.messaging.sink.data.acks=1
# [/Sink - data]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interacting_with_apache_kafka">8. Interacting with Apache Kafka</h3>
<div class="paragraph">
<p>You can connect to Apache Kafka as a source or sink. The Kafka support is based on the
<a href="https://vertx.io/docs/vertx-kafka-client/java/">Vert.x Kafka Client</a>.</p>
</div>
<div class="sect3">
<h4 id="_dependency">8.1. Dependency</h4>
<div class="paragraph">
<p>To enable the Kafka support, you need the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_messages_from_kafka">8.2. Retrieving messages from Kafka</h4>
<div class="paragraph">
<p>To retrieve messages from a Kafka topic, you need the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># [Source - heartbeat] - Consume data from Kafka
smallrye.messaging.source.kafka-heartbeat.type=io.smallrye.reactive.messaging.kafka.Kafka
smallrye.messaging.source.kafka-heartbeat.topic=heartbeat
smallrye.messaging.source.kafka-heartbeat.bootstrap.servers=localhost:9092
smallrye.messaging.source.kafka-heartbeat.enable.auto.commit=false
smallrye.messaging.source.kafka-heartbeat.group.id=demo
smallrye.messaging.source.kafka-heartbeat.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
smallrye.messaging.source.kafka-heartbeat.value.deserializer=io.vertx.kafka.client.serialization.JsonObjectDeserializer
# [/Source - heartbeat]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>type</code> attribute is required to indicate you are configuring the Kafka transport. Supported attributes are listed
in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The topic to consume</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bootstrap.servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the comma separated list of servers (host:port)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key.deserializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the codec used to deserialize the key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value.deserializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the codec used to deserialize the value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">group.id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the group id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enable.auto.commit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">whether or not the messages are committed automatically</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether it should retry to re-established the connection to the broker is it fails</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry-attempts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of retries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">broadcast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the received messages can be dispatched to several <code>@Incoming</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also configure any attributes used by the <a href="https://vertx.io/docs/vertx-kafka-client/java/">Vert.x Kafka client</a>.</p>
</div>
<div class="paragraph">
<p>When consuming a message from Kafka, you can get the <code>Message</code> as a <code>io.smallrye.reactive.messaging.kafka.KafkaMessage</code>.
It lets you access other metadata such as the headers, the message key (the payload being the value):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("from-kafka")
  public void consume(KafkaMessage&lt;String, JsonObject&gt; message) {
    JsonObject payload = message.getPayload();
    String key = message.getKey();
    MessageHeaders headers = message.getHeaders();
    Integer partition = message.getPartition();
    Long timestamp = message.getTimestamp();
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_messages_to_kafka">8.3. Forwarding messages to Kafka</h4>
<div class="paragraph">
<p>To send messages to a Kafka topic, you need the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># [Sink - data] - Produce data to Kafka
smallrye.messaging.sink.data.type=io.smallrye.reactive.messaging.kafka.Kafka
smallrye.messaging.sink.data.bootstrap.servers=localhost:9092
smallrye.messaging.sink.data.key.serializer=org.apache.kafka.common.serialization.StringSerializer
smallrye.messaging.sink.data.value.serializer=io.vertx.kafka.client.serialization.JsonObjectSerializer
smallrye.messaging.sink.data.acks=1
# [/Sink - data]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>type</code> attribute is required to indicate you are configuring the Kafka transport. Supported attributes are listed
in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The topic to consume, if not set it must be set in the <code>message</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bootstrap.servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the comma separated list of servers (host:port)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key.serializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the codec used to serialize the key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value.serializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the codec used to serialize the value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the key to be used, can be overridden by the message</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the partition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timestamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the timestamp</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also configure any attributes used by the <a href="https://vertx.io/docs/vertx-kafka-client/java/">Vert.x Kafka client</a>.</p>
</div>
<div class="paragraph">
<p>When sending a message to Kafka, you can send a Kafka message to configure various aspects such as the topic and key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Outgoing("to-kafka")
  public KafkaMessage&lt;String, String&gt; consume(Message&lt;String&gt; incoming) {
    return KafkaMessage.of("topic", "key", incoming.getPayload());
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_integrating_with_apache_camel">9. Integrating with Apache Camel</h3>
<div class="paragraph">
<p>You can receive messages from a Camel Route or send messages to a Camel route. It give you the ability to connect to
almost any existing system.</p>
</div>
<div class="sect3">
<h4 id="_dependency_2">9.1. Dependency</h4>
<div class="paragraph">
<p>To enable the Camel support, you need the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-camel&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_camel_reactive">9.2. Camel Reactive</h4>
<div class="paragraph">
<p>When using the dependency, your bean can retrieve a
 <code>org.apache.camel.component.reactive.streams.api.CamelReactiveStreamsService</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Default Camel Context
@Inject
private CamelContext camel;

// Camel Reactive service
@Inject
private CamelReactiveStreamsService camel_reactive;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_camel_route_in_outgoing_method">9.3. Using Camel Route in @Outgoing method</h4>
<div class="paragraph">
<p>Here is an example of method annotated with <code>@Outgoing</code> directly using a Camel route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Outgoing("camel")
public Publisher&lt;Exchange&gt; source() {
  return camel_reactive.from("seda:camel");
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_camel_route_in_incoming_method">9.4. Using Camel Route in @Incoming method</h4>
<div class="paragraph">
<p>Here is an example of method annotated with <code>@Incoming</code> directly using a Camel route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Incoming("camel")
public Subscriber&lt;String&gt; sink() {
  return camel.subscriber("file:./target?fileName=values.txt&amp;fileExist=append", String.class);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another possibility is to use a <em>producer</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Incoming("camel")
public CompletionStage&lt;Void&gt; sink(String value) {
  return camel.createProducerTemplate().asyncSendBody("file:./target?fileName=values.txt&amp;fileExist=append", value).thenApply(x -&gt; null);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_messages_from_a_camel_route">9.5. Retrieving messages from a Camel Route</h4>
<div class="paragraph">
<p>The previous example requires your code to deal with Maven route directly. It can be externalized to the configuration as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.source.data.type=io.smallrye.reactive.messaging.camel.Camel
smallrye.messaging.source.data.endpoint-uri:seda:my-route</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>endpoint-uri</code> configures the route to use. It can be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>reactive-stream</code> route such as <code>reactive-streams:out</code></p>
</li>
<li>
<p>a <em>regular</em> route such as <code>seda:my-route</code></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_messages_to_a_camel_route">9.6. Forwarding messages to a Camel Route</h4>
<div class="paragraph">
<p>The following configuration describe a sink using a Camel route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.sink.data.type=io.smallrye.reactive.messaging.camel.Camel
smallrye.messaging.sink.data.endpoint-uri:seda:my-route</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>endpoint-uri</code> configures the route to use. It can be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>reactive-stream</code> route such as <code>reactive-streams:in</code></p>
</li>
<li>
<p>a <em>regular</em> route such as <code>file:./target?fileName=values.txt&amp;fileExist=append</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the first case, it can be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class BeanWithCamelSinkUsingRSRoute extends RouteBuilder {

  @Outgoing("data")
  public Publisher&lt;Message&lt;String&gt;&gt; source() {
    return ReactiveStreams.of("a", "b", "c", "d")
      .map(String::toUpperCase)
      .map(Message::of)
      .buildRs();
  }

  // Declare a route
  @Override
  public void configure() {
    from("reactive-streams:in").to("file:./target?fileName=values.txt&amp;fileExist=append");
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interacting_using_mqtt">10. Interacting using MQTT</h3>
<div class="paragraph">
<p>You can connect to a MQTT broker or server as a source or sink. The MQTT support is based on the
<a href="https://vertx.io/docs/vertx-mqtt/java/#_vert_x_mqtt_client">Vert.x MQTT Client</a>.</p>
</div>
<div class="sect3">
<h4 id="_dependency_3">10.1. Dependency</h4>
<div class="paragraph">
<p>To enable the MQTT support, you need the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-mqtt&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_messages_from_mqtt">10.2. Retrieving messages from MQTT</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.source.data.topic=data
smallrye.messaging.source.data.type=io.smallrye.reactive.messaging.mqtt.Mqtt
smallrye.messaging.source.data.host=localhost
smallrye.messaging.source.data.port=8883
smallrye.messaging.source.data.username=username
smallrye.messaging.source.data.password=secret
smallrye.messaging.source.data.broadcast=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Message coming from MQTT are <code>Message&lt;byte[]&gt;</code>. The payload is a <code>byte[]</code>. You can also receive
<code>io.smallrye.reactive.messaging.mqtt.MqttMessage</code> which give you access to message metadata.</p>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_messages_to_mqtt">10.3. Forwarding messages to MQTT</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.sink.data.topic=data
smallrye.messaging.sink.data.type=io.smallrye.reactive.messaging.mqtt.Mqtt
smallrye.messaging.sink.data.host=localhost
smallrye.messaging.sink.data.port=8883
smallrye.messaging.sink.data.username=username
smallrye.messaging.sink.data.password=secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>The payload of message forwarded to MQTT must be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>io.vertx.core.json.JsonObject</code> or a <code>io.vertx.core.json.JsonArray</code></p>
</li>
<li>
<p>a <code>String</code> or a primitive types</p>
</li>
<li>
<p>a <code>byte[]</code> or a Vert.x Buffer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other objects are mapped to JSON.</p>
</div>
</div>
<div class="sect3">
<h4 id="_advanced_configuration">10.4. Advanced configuration</h4>
<div class="paragraph">
<p>Check <code>io.smallrye.reactive.messaging.mqtt.MqttSource.MqttSource</code> and
<code>io.smallrye.reactive.messaging.mqtt.MqttSource.MqttSink</code> for further details on the attributes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_emitting_http_requests">11. Emitting HTTP requests</h3>
<div class="paragraph">
<p>You can also <em>push</em> the incming messages to a HTTP endpoint using the <em>HTTP connector</em>.</p>
</div>
<div class="sect3">
<h4 id="_dependency_4">11.1. Dependency</h4>
<div class="paragraph">
<p>To enable the MQTT support, you need the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-http&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_messages_to_http">11.2. Forwarding messages to HTTP</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.sink.data.url=http://localhost:8089
smallrye.messaging.sink.data.type=io.smallrye.reactive.messaging.http.Http</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your method can also returns a <code>HttpMessage</code> to configure the <em>headers</em>, <em>query parameters</em>, the HTTP method (<code>POST</code>
(default) or <code>PUT</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Incoming("source")
  @Outgoing("to-http")
  public HttpMessage&lt;JsonObject&gt; consume(Message&lt;String&gt; incoming) {
    return HttpMessage.HttpMessageBuilder.&lt;JsonObject&gt;create()
      .withMethod("PUT")
      .withPayload(new JsonObject().put("value", incoming.getPayload().toUpperCase()))
      .withHeader("Content-Type", "application/json")
      .build();
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Supported payloads are:
* String
* Vert.x Buffers, byte array, <code>ByteBuffer</code>
* Vert.x <code>JsonObject</code> and <code>JsonArray</code></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interacting_with_the_vert_x_eventbus">12. Interacting with the Vert.x Eventbus</h3>
<div class="paragraph">
<p>The Vert.x Eventbus is the backbone of Vert.x applications. It allows different application components to interact in
an asynchronous way.</p>
</div>
<div class="sect3">
<h4 id="_dependency_5">12.1. Dependency</h4>
<div class="paragraph">
<p>To enable the Vert.x EventBus support, you need the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
  &lt;artifactId&gt;smallrye-reactive-messaging-vertx-eventbus&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_messages_from_the_event_bus">12.2. Retrieving messages from the event bus</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.source.data.address=&lt;the-eventbus-address&gt;
smallrye.messaging.source.data.type=io.smallrye.reactive.messaging.eventbus.VertxEventBus
smallrye.messaging.source.data.use-reply-as-ack=&lt;true|false&gt;
smallrye.messaging.source.data.broadcast=&lt;true|false&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>address</code> indicates from which event bus address the messages are retrieved. <code>use-reply-as-ack</code> instructs the
framework to reply to the event bus message as acknowledgement mechanism. Finally, the <code>broadcast</code> entry broadcasts the
to many subscribers.</p>
</div>
<div class="paragraph">
<p>The received messages are instance of <code>io.smallrye.reactive.messaging.eventbus.EventBusMessage</code>. The payload is the message
body. From the <code>EventBusMessage</code>, you can retrieve the headers, address&#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="_sending_messages_to_the_event_bus">12.3. Sending messages to the event bus</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>smallrye.messaging.source.data.address=&lt;the-eventbus-address&gt;
smallrye.messaging.source.data.type=io.smallrye.reactive.messaging.eventbus.VertxEventBus
smallrye.messaging.source.data.publish=&lt;true|false&gt;
smallrye.messaging.source.data.expect-reply=&lt;true|false&gt;
smallrye.messaging.source.data.codec=&lt;codec-name&gt;
smallrye.messaging.source.data.timeout=1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>address</code> indicates where the messages are sent. <code>publish</code> choose whether the message is sent to a single consumer (
<code>false</code>) or broadcast (<code>true</code>). <code>expect-reply</code> indicates if you expect a reply. No other messages will be sent until the
reply is received. <code>codec</code> is the name of the codec (it must have been registered explicitly). Finally, the <code>timeout</code>
specifies the reply timeout.</p>
</div>
<div class="paragraph">
<p>The event bus message is created from the Reactive Messaging message. The payload is passed as body.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_and_experimental_features">13. Advanced and Experimental features</h3>
<div class="sect3">
<h4 id="_merge">13.1. @Merge</h4>
<div class="paragraph">
<p>The <code>@Merge</code> annotation can be used on a method annotated with <code>@Incoming</code> to subscribed to all matching `@Outgoing
streams. For example, if you have several method producing data to a stream named "sink", the following method receives
all of them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Incoming("sink")
@Merge
@Acknowledgment(Acknowledgment.Mode.NONE)
public CompletionStage&lt;Void&gt; justASink(Message&lt;String&gt; ignored) {
  return CompletableFuture.completedFuture(null);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Merge</code> annotation can be configured with a <em>merge policy</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ONE</code> - Pick the first source and use only this one.</p>
</li>
<li>
<p><code>MERGE</code> - Merge the different sources. This strategy emits the items as they come. (default)</p>
</li>
<li>
<p><code>CONCAT</code> - Concat the sources.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_broadcast">13.2. @Broadcast</h4>
<div class="paragraph">
<p>The <code>@Broadcast</code> annotation can be used on a method annotation with <code>@Outgoing</code> to broadcast the emitted messages to all
the matching subscribers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Outgoing("Y")
@Incoming("X")
@Broadcast
public String process(String s) {
  return s.toUpperCase();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stream">13.3. @Stream</h4>
<div class="paragraph">
<p><code>@Stream</code> is a qualifier to inject a <em>stream</em> into a regular CDI bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Stream("hello")
private Publisher&lt;Message&lt;String&gt;&gt; field;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value indicates the name of the stream. You can inject a stream as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Publisher&lt;Message&lt;X&gt;&gt;</code> or <code>Publisher&lt;X&gt;</code></p>
</li>
<li>
<p><code>PublisherBuilder&lt;Message&lt;X&gt;&gt;</code> or <code>PublisherBuilder&lt;X&gt;</code></p>
</li>
<li>
<p><code>Flowable&lt;Message&lt;X&gt;&gt;</code> or <code>Flowable&lt;X&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_logging">13.4. Logging</h4>
<div class="paragraph">
<p>The logging uses Log4j2. Configure it by adding a <code>log4j2.yaml</code> file in your <em>CLASSPATH</em> (or in <code>src/main/resources</code>).
The configuration is explained in the <a href="https://logging.apache.org/log4j/2.x/manual/configuration.html">Log4J2 configuration</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_strict_binding_mode">13.5. Strict Binding Mode</h4>
<div class="paragraph">
<p>By default, SmallRye Reactive Messaging does not enforce whether all <em>mediators</em> are connected. It just print a warning
message. The strict mode fails the deployment if some "incoming" are not connected to "outgoing". To enable this mode,
pass the <code>-Dsmallrye-messaging-strict-binding=true</code> to the command line.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0-SNAPSHOT<br>
Last updated 2018-11-09 21:27:18 CET
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>